# 예제 4: 예제 1의 데이터를 이용해 파이썬으로 분산분석(ANOVA)을 수행한다.

# 예제 1 배경 설명:
# 안경 렌즈의 표면이 긁히는 것을 막기 위해, 
# A, B, C, D 네 가지 방식의 코팅처리를 적용한 후
# 각 코팅의 마모 정도(숫자가 높을수록 마모가 큼)를 측정한 실험이다.
# 네 처리 간 평균 마모도 차이가 있는지를 통계적으로 검정한다.

import numpy as np
import pandas as pd

# 마모도 측정값 (총 22개 데이터)
y = np.array([
    10, 15, 8, 12, 15,           # A 코팅 (5개)
    14, 18, 21, 15,              # B 코팅 (4개)
    17, 16, 14, 15, 17, 15, 18,  # C 코팅 (7개)
    12, 15, 17, 15, 16, 15       # D 코팅 (6개)
])

# 처리 집단 (A, B, C, D) 레이블 지정
treat = np.repeat(['A', 'B', 'C', 'D'], [5, 4, 7, 6])

# 데이터프레임 생성
data = pd.DataFrame({'y': y, 'treat': treat})

#-----------------------------------------------------------

# 선형모형 및 분산분석 수행
import statsmodels.api as sm
import statsmodels.formula.api as smf

# 선형 회귀모형 적합: 종속변수 y, 독립변수 treat
ImFit = smf.ols('y ~ treat', data=data).fit()

# 분산분석(ANOVA) 테이블 생성
anova_table = sm.stats.anova_lm(ImFit)
print(anova_table)

#-----------------------------------------------------------

# 해석:
# PR(>F) = 0.1814 ▶ p값이 0.05보다 크므로,
# 네 종류 코팅 처리 간 평균 마모도의 차이가 통계적으로 유의하지 않음.
# 즉, 실험 결과만으로는 코팅 방식 간 차이가 있다고 보기 어려움.